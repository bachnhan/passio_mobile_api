@using HmsService.Models;
@using HmsService.Models.Entities
@using HmsService.Sdk
@model HmsService.ViewModels.StoreViewModel
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<style>
    .myHr {
        border-bottom: 1px solid lightgray;
        margin-top: 0px !important;
    }

    .funkyradio div {
        /*margin: 0 50px;*/
        overflow: hidden;
    }

    .funkyradio label {
        /*min-width: 400px;*/
        width: 100%;
        border-radius: 3px;
        border: 1px solid #D1D3D4;
        font-weight: normal;
    }

    .funkyradio input[type="radio"]:empty, .funkyradio input[type="checkbox"]:empty {
        display: none;
    }

        .funkyradio input[type="radio"]:empty ~ label, .funkyradio input[type="checkbox"]:empty ~ label {
            position: relative;
            line-height: 2.5em;
            text-indent: 3.25em;
            margin-top: 0em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

            .funkyradio input[type="radio"]:empty ~ label:before, .funkyradio input[type="checkbox"]:empty ~ label:before {
                position: absolute;
                display: block;
                top: 0;
                bottom: 0;
                left: 0;
                content: '';
                width: 2.5em;
                background: #D1D3D4;
                border-radius: 3px 0 0 3px;
            }

    .funkyradio input[type="radio"]:hover:not(:checked) ~ label:before, .funkyradio input[type="checkbox"]:hover:not(:checked) ~ label:before {
        content: '\2714';
        text-indent: .9em;
        color: #C2C2C2;
    }

    .funkyradio input[type="radio"]:hover:not(:checked) ~ label, .funkyradio input[type="checkbox"]:hover:not(:checked) ~ label {
        color: #888;
    }

    .funkyradio input[type="radio"]:checked ~ label:before, .funkyradio input[type="checkbox"]:checked ~ label:before {
        content: '\2714';
        text-indent: .9em;
        color: #333;
        background-color: #ccc;
    }

    .funkyradio input[type="radio"]:checked ~ label, .funkyradio input[type="checkbox"]:checked ~ label {
        color: #777;
    }

    .funkyradio input[type="radio"]:focus ~ label:before, .funkyradio input[type="checkbox"]:focus ~ label:before {
        box-shadow: 0 0 0 3px #999;
    }

    .funkyradio-default input[type="radio"]:checked ~ label:before, .funkyradio-default input[type="checkbox"]:checked ~ label:before {
        color: #333;
        background-color: #ccc;
    }

    .funkyradio-primary input[type="radio"]:checked ~ label:before, .funkyradio-primary input[type="checkbox"]:checked ~ label:before {
        color: #fff;
        background-color: #337ab7;
    }

    .funkyradio-success input[type="radio"]:checked ~ label:before, .funkyradio-success input[type="checkbox"]:checked ~ label:before {
        color: #fff;
        background-color: #5cb85c;
    }

    .funkyradio-danger input[type="radio"]:checked ~ label:before, .funkyradio-danger input[type="checkbox"]:checked ~ label:before {
        color: #fff;
        background-color: #d9534f;
    }

    .funkyradio-warning input[type="radio"]:checked ~ label:before, .funkyradio-warning input[type="checkbox"]:checked ~ label:before {
        color: #fff;
        background-color: #f0ad4e;
    }

    .funkyradio-info input[type="radio"]:checked ~ label:before, .funkyradio-info input[type="checkbox"]:checked ~ label:before {
        color: #fff;
        background-color: #5bc0de;
    }

    .chartOption {
        cursor: pointer;
    }

    .widget-header {
        cursor: pointer;
    }

    .infobox {
        height: 100px !important;
    }

    .chartOptionActive {
        font-weight: bold;
    }

    #storePieChart {
        margin-top: 80px;
    }

    /*  bhoechie tab */
    div.bhoechie-tab-container {
        z-index: 10;
        background-color: #ffffff;
        padding: 0;
        border-radius: 4px;
        -moz-border-radius: 4px;
        /*border: 1px solid #ddd;*/
        -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
        -moz-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        background-clip: padding-box;
        opacity: 0.97;
        filter: alpha(opacity=97);
    }

    div.bhoechie-tab-menu {
        padding-right: 0;
        padding-left: 0;
        padding-bottom: 0;
        background-color: rgba(44, 73, 73, 1);
        border-top-right-radius: 4px;
        border-top-left-radius: 4px;
    }

    a.list-group-item {
        color: #ffffff !important;
        background-color: rgba(44, 73, 73, 1) !important;
        border: 0 !important;
    }

        a.list-group-item:hover,
        button.list-group-item:hover,
        a.list-group-item:focus,
        button.list-group-item:focus {
            text-decoration: none !important;
            color: #ffffff !important;
            background-color: rgba(44, 73, 73, 1) !important;
        }

    .no-padding {
        padding-right: 0;
        padding-left: 0;
    }

    .bhoechie-tab-menu .list-group {
        margin-bottom: 0;
        /*border: 0;*/
    }

        .bhoechie-tab-menu .list-group li {
            width: 25%;
        }

        .bhoechie-tab-menu .list-group a {
            margin-bottom: 0;
        }

            .bhoechie-tab-menu .list-group a .glyphicon,
            .bhoechie-tab-menu .list-group a .fa {
                color: #fff;
            }

            .bhoechie-tab-menu .list-group a:first-child {
                border-radius: 0;
                -moz-border-radius: 0;
            }

            /*.bhoechie-tab-menu .list-group  a:last-child {
            border-bottom-right-radius: 0;
            -moz-border-bottom-right-radius: 0;
        }*/

            .bhoechie-tab-menu .list-group a.active,
            .bhoechie-tab-menu .list-group a.active .glyphicon,
            .bhoechie-tab-menu .list-group a.active .fa {
                background-color: #fff !important;
                color: rgba(44, 73, 73, 1) !important;
            }

                .bhoechie-tab-menu .list-group a.active:after {
                    content: '';
                    position: absolute;
                    top: 100%;
                    margin-left: -44px;
                    /* border-left: 0; */
                    border-right: 13px solid transparent;
                    border-left: 13px solid transparent;
                    border-top: 10px solid rgba(44, 73, 73, 1);
                }

    div.bhoechie-tab-content {
        background-color: #ffffff;
        /* border: 1px solid #eeeeee; */
        padding-left: 10px;
        padding-top: 10px;
    }

    a.list-group-item,
    button.list-group-item {
        color: #fff;
    }

    /*div.bhoechie-tab-content > .col-lg-6, .col-md-6 {
        padding-top: 50px;
    }

    div.bhoechie-tab-content > .col-sm-12, .col-xs-12 {
        padding-top: 20px;
    }

    div.bhoechie-tab div.bhoechie-tab-content:not(.active) {
        display: none;
    }*/

    .row {
        margin-top: 10px;
    }

    .clearfix > * {
        color: #fff;
    }

    .nav-tabs {
        border-bottom: 1px solid rgba(44, 73, 73, 1);
    }

    .infobox-data > h1, h3 {
        color: #fff;
        margin-top: 0;
    }

    .padding15 {
        padding-bottom: 15px;
        padding-top: 15px;
        padding-left: 15px;
        padding-right: 15px;
    }

    .bgm-wheat {
        background-color: wheat !important;
    }

    .bgm-cadet {
        background-color: cadetblue;
    }

    .bgm-seagreen {
        background-color: seagreen;
    }

    .bgm-sandbrown {
        background-color: sandybrown;
    }

    .margin-in-col {
        margin-left: -5px;
        margin-right: -5px;
    }

    .my-widget {
        border-radius: 10px;
        margin-right: 15px;
    }

    .widget-rev {
        background-color: darkslategrey;
    }

    .widget-rev-odd {
        background-color: rgba(44, 73, 73, 1);
    }

    .wdidget-as {
        background-color: rgba(200, 81, 81, 1);
    }

    .wdidget-as-odd {
        background-color: rgba(191, 79, 79, 1);
    }

    .widget-del {
        background-color: rgba(204, 155, 30, 1);
    }

    .widget-del-odd {
        background-color: rgba(195, 148, 29, 1);
    }

    .wdidget-ta {
        background-color: darkolivegreen;
    }

    .wdidget-ta-odd {
        background-color: rgba(83, 103, 50, 1);
    }

    .infobox-content {
        visibility: hidden;
    }

    .dataTables_wrapper.no-footer .dataTables_scrollBody {
        border-bottom: 1px solid lightgray;
    }

    #storeReportDatatable > thead {
        visibility: hidden;
        border: 0;
    }

    #storeReportDatatable tr[role=row] {
        cursor: pointer;
    }

    .tableDiv-responsive {
        width: 100%;
    }
</style>
<div class="card">
    <div class="card-header">
        <div class="box-header">
            <div class="row">
                <div class="col-md-6">
                    <h3>Cửa hàng @Model.Name</h3>
                </div>
            </div>
        </div>
        <hr />
    </div>
    <div class="card-body card-padding">
        <div class="card">
            <div class="card-header card-padding">
                    <h2>Tùy chọn</h2>
            </div>
            <div class="card-body card-padding row">
                <div class="col-md-6 col-xs-6 p-15">
                    <div class="padding15 margin-in-col wdidget-ta-odd">
                        <div class="clearfix">
                            <center>
                                <i class="fa fa-calendar-check-o fa-5x p-b-15" aria-hidden="true"></i>
                                <br />
                                <h3>Tùy Chọn Ngày</h3>
                            </center>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col wdidget-ta">
                        <div class="clearfix">
                            <label class="control-label col-md-4"><i class="fa fa-calendar fa-2x" aria-hidden="true"></i>Chọn ngày</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <input class="form-control" type="text" id="ChooseDate" value="@DateTime.Now.Date.ToString("dd/MM/yyyy")" onchange="LoadShiftInDate()" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col wdidget-ta-odd">
                        <div class="clearfix">
                            <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-list-ul fa-2x" aria-hidden="true"></i>Số ca trong ngày</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label id="totalShift"></label> ca làm việc
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xs-6 p-15">
                    <div class="padding15 margin-in-col wdidget-as-odd">
                        <div class="clearfix">
                            <center>
                                <i class="fa fa-check-square-o fa-5x p-b-15" aria-hidden="true"></i>
                                <br />
                                <h3>Tùy Chọn Ca</h3>
                            </center>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col wdidget-as">
                        <div class="clearfix">
                            <label class="control-label col-md-4"><i class="fa fa-shirtsinbulk fa-2x" aria-hidden="true"></i>Chọn ca</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <select class="selectpicker width-100" name="Shift" id="Shift" onchange="ChooseShift()"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col wdidget-as-odd">
                        <div class="clearfix">
                            <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-file-excel-o fa-2x" aria-hidden="true"></i>Xuất chi tiết</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <button id="exportOneShift" class="width230 btn btn-primary btn-sm" onclick="exportExcellOneShift()">
                                        <i class="fa fa-download"></i>
                                        Xuất ra file Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
            @*<div class="card-body card-padding row">
                <div class="col-md-6">
                    <div class="form-group  row">
                        <button id="exportOneShift" class="width230 btn btn-primary btn-sm" onclick="exportExcellOneShift()">
                            <i class="fa fa-download"></i>
                            Xuất ra file Excel
                        </button>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group  row">
                        <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-calendar" aria-hidden="true"></i>Chọn ngày</label>
                        <div class="col-md-8">
                            <div class="fg-line">
                                <input class="form-control" type="text" id="ChooseDate" value="@DateTime.Now.Date.ToString("dd/MM/yyyy")" onchange="LoadShiftInDate()" />
                            </div>
                        </div>
                    </div>
                    <div class="form-group  row">
                        <label class="control-label col-md-4"><i class="fa fa-shirtsinbulk" aria-hidden="true"></i>Chọn ca</label>
                        <div class="col-md-8">
                            <div class="fg-line">
                                <select class="selectpicker width-100" name="Shift" id="Shift" onchange="ChooseShift()"></select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>*@
        </div>
        <div class="card">
            <div class="card-header card-padding">
                <h2>Tổng quan: <label id="ShiftName"></label> - <label id="ShiftDate"></label></h2>
            </div>
            <div class="card-body card-padding row">
                <div class="col-md-6 col-xs-6 p-15">
                    <div class="padding15 margin-in-col widget-del-odd">
                        <div class="clearfix">
                            <center>
                                <i class="fa fa-pie-chart fa-5x p-b-15" aria-hidden="true"></i>
                                <br />
                                <h3>Thông Tin Chung</h3>
                            </center>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col widget-del">
                        <div class="clearfix">
                            <label class="control-label col-md-4"><i class="fa fa-calendar fa-2x" aria-hidden="true"></i>Khung giờ</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label class="label" style="font-size: smaller; background-color:darkgreen" id="StartTime"></label> đến <label class="label" style="font-size: smaller; background-color: firebrick" id="EndTime"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col widget-del-odd">
                        <div class="clearfix">
                            <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-clock-o fa-2x" aria-hidden="true"></i>Tổng giờ làm</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label id="totalWorkTimeOfShift"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col widget-del">
                        <div class="clearfix">
                            <label class="control-label col-md-4"><i class="fa fa-user fa-2x" aria-hidden="true"></i>Giờ làm TB</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label id="avgTotalWorkTimeOfShift" class="label" style="font-size: smaller; background-color: cadetblue"></label> <label id="avgTotalWorkTimeOfShiftInfo"></label>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xs-6 p-15">
                    <div class="padding15 margin-in-col widget-rev-odd">
                        <div class="clearfix">
                            <center>
                                <i class="fa fa-user-circle-o fa-5x p-b-15" aria-hidden="true"></i>
                                <br />
                                <h3>Thông Tin Nhân Viên</h3>
                            </center>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col widget-rev">
                        <div class="clearfix">
                            <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-users fa-2x" aria-hidden="true"></i>Nhân viên Assigned</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label id="numberOfEmp"></label> nhân viên
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col widget-rev-odd">
                        <div class="clearfix">
                            <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-user-times fa-2x" aria-hidden="true"></i>Giờ làm chưa xác định</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label id="numberNA"></label> nhân viên
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="padding15 margin-in-col widget-rev">
                        <div class="clearfix">
                            <label for="Product_Code" class="control-label col-md-4"><i class="fa fa-exclamation-triangle fa-2x" aria-hidden="true"></i>Đi trễ về sớm</label>
                            <div class="col-md-8">
                                <div class="fg-line">
                                    <label id="numberLate"></label> nhân viên
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header card-padding">
                <h2 class="col-md-6">Chi tiết</h2>
                @*<div class="form-group col-md-12">
                        @*<div class="input-group-btn FindButtonDateTime">
                                <a class="btn btn-primary FindDateTime" onclick="chooseSearch()" style="height: 35px">
                                    <i class="left-icon fa fa-search"></i> Tìm
                                </a>
                            </div>

                    </div>*@
                @*<div class="row col-md-6" style="text-align: right">
                        <button class="btn btn-primary btn-sm" onclick="chooseSearch()">
                            <i class="left-icon fa fa-search"></i> Tìm bộ lọc
                        </button>
                        <button id="exportOneShift" class="width230 btn btn-primary btn-sm" onclick="exportExcellOneShift()">
                            <i class="fa fa-download"></i>
                            Xuất ra file Excel
                        </button>
                    </div>*@
            </div>
            <div class="row">
                <div class="col-md-2 pull-left p-l-45">
                    <button class="btn btn-primary" id="filter-toggle" data-target="#filter-container" data-toggle="collapse" onclick="toggleIcon()"><i id="icon" class="fa fa-plus"></i> Bộ lọc</button>
                </div>
            </div>

            <div class="collapse p-l-45" id="filter-container">
                <div class="row m-t-10">
                    <div class="col-md-9">
                        <div class="col-md-2 p-l-0 p-r-0">
                            <label class="control-label p-t-5">Loại nhân viên:</label>
                            <input type="hidden" id="EmployeeType" value="-1" />
                        </div>
                        <div class="group-radio-buttons col-md-10 p-l-0">
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="status-filter" value="-1" class="nice-check" id="rbEmpTypeAll" checked onchange="reloadEmpType()" />
                                <label for="rbEmpTypeAll"><span>Tất cả</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="status-filter" value="0" class="nice-check" id="rbEmpTypeAssigned" onchange="reloadEmpType()" />
                                <label for="rbEmpTypeAssigned"><span>Đã được phân công</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="status-filter" value="1" class="nice-check" id="rbEmpTypeNotAssigned" onchange="reloadEmpType()" />
                                <label for="rbEmpTypeNotAssigned"><span>Chưa được phân công</span></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row m-t-10">
                    <div class="col-md-9">
                        <div class="col-md-2 p-l-0 p-r-0">
                            <label class="control-label p-t-5">Trạng thái:</label>
                            <input type="hidden" id="Status" value="-1" />
                        </div>
                        <div class="group-radio-buttons col-md-10 p-l-0">
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="mode-filter" value="-1" class="nice-check" id="rbStatusAll" checked onchange="reloadStatus()" />
                                <label for="rbStatusAll"><span>Tất cả</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="mode-filter" value="@((int)StatusAttendanceEnum.Processing)" class="nice-check" id="rbStatusProcessing" onchange="reloadStatus()" />
                                <label for="rbStatusProcessing"><span>Chờ duyệt</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="mode-filter" value="@((int)StatusAttendanceEnum.Approved)" class="nice-check" id="rbStatusApproved" onchange="reloadStatus()" />
                                <label for="rbStatusApproved"><span>Đã duyệt</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="mode-filter" value="@((int)StatusAttendanceEnum.Reject)" class="nice-check" id="rbStatusReject" onchange="reloadStatus()" />
                                <label for="rbStatusReject"><span>Đã hủy</span></label>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="row m-t-10">
                    <div class="col-md-9">
                        <div class="col-md-2 p-l-0 p-r-0">
                            <label class="control-label p-t-5">Tình trạng</label>
                            <input type="hidden" id="isLate" value="-1" />
                        </div>
                        <div class="group-radio-buttons col-md-10 p-l-0">
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="type-filter" value="-1" class="nice-check" id="rbIsLateAll" checked onchange="reloadIsLate()" />
                                <label for="rbIsLateAll"><span>Tất cả</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="type-filter" value="0" class="nice-check" id="rbIsLate" onchange="reloadIsLate()" />
                                <label for="rbIsLate"><span>Đi trễ</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="type-filter" value="1" class="nice-check" id="rbIsEarly" onchange="reloadIsLate()" />
                                <label for="rbIsEarly"><span>Về sớm</span></label>
                            </div>
                            <div class="medium-radio-button-width col-md-3 p-l-0">
                                <input type="radio" name="type-filter" value="2" class="nice-check" id="rbIsNotLate" onchange="reloadIsLate()" />
                                <label for="rbIsNotLate"><span>Đúng giờ</span></label>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            @*<div class="row">
                    <div class="col-md-12" style="margin-top: 15px;">
                        <div class="form-group col-md-4">
                            <span class="col-md-5 control-label p-t-10">Loại nhân viên</span>
                            <div class="col-md-7">
                                <select class="form-control selectpicker" data-live-search="true" name="EmployeeType" id="EmployeeType">
                                    <option value="-1">--- Chọn ---</option>
                                    <option value="0">Đã được phân công</option>
                                    <option value="1">Chưa được phân công</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-md-4">
                            <span class="col-md-5 control-label p-t-10">Trạng thái</span>
                            <div class="col-md-7">
                                <select class="form-control selectpicker" data-live-search="true" name="Status" id="Status">
                                    <option value="-1">--- Chọn ---</option>
                                    <option value="0">Chờ duyệt</option>
                                    <option value="1">Đã duyệt</option>
                                    <option value="2">Đã hủy</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-md-4">
                            <span class="col-sm-5 control-label p-r-0 p-t-10">Tình trạng</span>
                            <div class="col-sm-7">
                                <select class="form-control selectpicker" data-live-search="true" name="isLate" id="isLate">
                                    <option value="-1">--- Chọn ---</option>
                                    <option value="0">Đi trễ</option>
                                    <option value="1">Về sớm</option>
                                    <option value="2">Đúng giờ</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>*@

            <!-- Customer Table -->
            <div class="card-body card-padding row">
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="allcust">
                        <!-- Datatable -->
                        <div class="col-md-12">

                            <table id="detail-table" class="table table-hover" cellspacing="0" style="table-layout: auto">
                                <thead>
                                    <tr>
                                        <th><label>STT</label></th>
                                        <th><label>Nhân viên</label></th>
                                        <th><label>Giờ vào</label></th>
                                        <th><label>Giờ ra</label></th>
                                        <th><label>Chi tiết</label></th>
                                        <th><label>Tổng giờ làm</label></th>
                                        <th><label>Trạng thái</label></th>
                                        <th><label>Ghi chú</label></th>
                                        <th><label>Duyệt</label></th>
                                        @*<th><label>Tình trạng</label></th>*@
                                        <th><label>Sửa</label></th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            <div class="pull-left">
                                <label><i class="fa fa-tag" aria-hidden="true"></i> &nbsp;Chú thích:</label> <br /> <br />
                                <label class="label label-primary" style="font-size: small; margin-left: 20px">A</label> : Nhân viên cửa hàng khác <br /><br />
                                <label class="label label-default" style="font-size: small; margin-left: 20px">A</label> : Nhân viên cửa hàng <br /><br />
                                <i class="fa fa-star" aria-hidden="true" style="color: #d9534f; margin-left: 20px"></i> : Nhân viên chưa được phân công
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="create-modal-container">
    <div class="modal" id="edit-modal-timekeeping" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog" role="document" style="width:800px;">
            <div class="modal-content">
                <div class="form-horizontal">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Sửa thông tin trong ca: <label id="EditAtt"></label></h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">Trạng thái</label>
                            <div class="col-sm-9">
                                @*<div class="group-radio-buttons myGroup-radio-buttons">
                                        <div class="col-md-4 p-l-0 p-t-0">
                                            <input type="radio" name="filter-type" value="0" class="nice-check" id="rbProcessing" />
                                            <label for="rbProcessing"><span class="label label-warning p-l-45 p-r-45 p-t-5 p-b-5" style="font-size: smaller">Chờ duyệt</span></label>
                                        </div>
                                        <div class="col-md-4 p-l-0 p-t-0">
                                            <input type="radio" name="filter-type" value="1" class="funkyradio-success col-md-6" id="rbApproved" />
                                            <label for="rbApproved" class="col-md-6"><span class="label label-success p-l-45 p-r-45 p-t-5 p-b-5" style="font-size: smaller">Đã duyệt</span></label>
                                        </div>
                                        <div class="col-md-4 p-l-0 p-t-0">
                                            <input type="radio" name="filter-type" value="2" class="nice-check" id="rbReject" />
                                            <label for="rbReject"><span class="label label-danger p-l-45 p-r-45 p-t-5 p-b-5" style="font-size: smaller">Đã hủy</span></label>
                                        </div>
                                    </div>*@
                                <div class="funkyradio col-md-12">
                                    <div class="funkyradio-success col-md-3 p-l-0 p-t-0">
                                        <input type="radio" name="radio" value="1" id="rbApproved" />
                                        <label for="rbApproved" style="color: #5cb85c; font-weight: bold">Đã duyệt</label>
                                    </div>
                                    <div class="funkyradio-danger col-md-3 p-l-0 p-t-0">
                                        <input type="radio" name="radio" value="2" id="rbReject" />
                                        <label for="rbReject" style="color: #d9534f; font-weight: bold">Đã hủy</label>
                                    </div>
                                    <div class="funkyradio-warning col-md-3 p-l-0 p-t-0">
                                        <input type="radio" name="radio" value="0" id="rbProcessing" />
                                        <label for="rbProcessing" style="color: #f0ad4e; font-weight: bold">Chờ duyệt</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*<div class="form-group">
                                <input type="hidden" id="attId">
                                <label class="col-sm-3 control-label">Người duyệt</label>
                                <div class="col-sm-9">
                                    <label id="updatePerson" class="label label-primary p-l-45 p-r-45 p-t-5 p-b-5"></label>
                                </div>
                            </div>*@
                        <div class="form-group">
                            <input type="hidden" id="attId">
                            <label class="col-sm-3 control-label">Giờ nhân viên vào</label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="TimeFrameStart" name="TimeFrameStart" placeholder="Giờ nhân viên vào">
                            </div>
                        </div>
                        @*<div class="form-group">
                                <label class="col-sm-3 control-label">Thời lượng nhân viên làm</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="DurationInShift" name="TimeFrameEnd" placeholder="Thời lượng nhân viên làm">
                                </div>
                            </div>*@
                        <div class="form-group">
                            <label class="col-sm-3 control-label">Giờ nhân viên ra</label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="TimeFrameEnd" name="TimeFrameEnd" placeholder="Giờ nhân viên ra">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">Ghi chú</label>
                            <div class="col-sm-9">
                                <textarea rows="4" cols="78" lass="form-control" id="TextAreaNote" name="TextAreaNote"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <input type="hidden" id="isOverrideInput" />
                            <div class="checkbox col-sm-9 pull-right">
                                <label>
                                    Cho phép chương trình tự động cập nhật lại dữ liệu<input type="checkbox" id="IsOverride" /><i class="input-helper"></i>
                                </label>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">Đóng</button>
                        <button type="submit" id="btnAction" onclick="EditAttendance()" class="btn btn-success btn-sm pull-right">Hoàn Tất</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        // --- Load datatable
        $(document).ready(function () {
            $("#isOverrideInput").val(3);
            loadShiftFromDB();
            //GetShiftInFo();
            //loadAttendance();
            $('#TimeFrameStart').datetimepicker({
                sideBySide: true,
                format: 'DD/MM/YYYY HH:mm',
                ignoreReadonly: true,
                toolbarPlacement: 'bottom'
            });


            $('#TimeFrameEnd').datetimepicker({
                sideBySide: true,
                format: 'DD/MM/YYYY HH:mm',
                ignoreReadonly: true,
                toolbarPlacement: 'bottom'
            });
                $("#ChooseDate").daterangepicker({
                    singleDatePicker: true,
                    locale: {
                        format: 'DD/MM/YYYY'
            },
                startDate: moment(),
                showDropdowns: true
            });
        });
        function toggleIcon(){
            $('#icon').toggleClass("fa-plus");
            $('#icon').toggleClass("fa-minus");
        }

        function LoadShiftInDate() {
            loadShiftFromDB();
        }

        function loadShiftFromDB() {
            $.ajax({
                type: 'POST',
                data: { 'startTime': $('#ChooseDate').val(), 'endTime': $('#ChooseDate').val() },
                url: '@Url.Action("GetDateShift", "Shift")',
                success: function (result) {
                    $("#totalShift").text(result.length);
                    loadShift(result);
                }
            });
        }

        function loadShift(listData) {
            $("#Shift").empty();
            for (var i = 0; i < listData.length; i++) {
                $("#Shift").append('<option value="' + listData[i][6] + '">' + listData[i][1] + '</option>');
            }
            $("#Shift").selectpicker('refresh');
            ChooseShift();
        }

        function ChooseShift() {
            $("#ShiftDate").text($("#ChooseDate").val());
            $("#ShiftName").text($("#Shift option:selected").text());
            GetShiftInfo();
            loadAttendance();
        }

        function GetShiftInfo() {
            if ($("#Shift").val() == null) {
                return;
            }

            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetShiftInFo", "Shift")',
                data: {
                    'shiftId': $("#Shift").val(),
                },
                success: function(result) {
                    $("#StartTime").text(result.startTime);
                    $("#EndTime").text(result.endTime);
                },
                error: function(error) {
                    showMessage("Cõ lỗi xảy ra. Vui lòng thử lại sau.", "error", "OK");
                }
            });
        }
        function loadAttendance() {
            if ($("#Shift").val() == null) {
                return;
            }
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetAttendance")',
                data: {
                    'shiftId': $("#Shift").val(),
                    'status': $("#Status").val(),
                    'empType': $("#EmployeeType").val(),
                    'isLate': $("#isLate").val(),
                },
                success: function(result) {
                    initDatatable(result.result);
                    $("#numberOfEmp").text(result.numberOfEmp);
                    $("#totalWorkTimeOfShift").text(result.totalWorkTimeOfShift);
                    $("#avgTotalWorkTimeOfShift").text(result.avgTotalWorkTimeOfShift);
                    $("#avgTotalWorkTimeOfShiftInfo").text(" (Được tính trên " +
                        result.numberOfEmpCheckRight +
                        " nhân viên có giờ làm xác định)");
                    $("#numberNA").text(result.numberOfEmpNA);
                    $("#numberLate").text(result.numberOfEmpNotRight);
                },
                error: function(error) {
                    showMessage("Cõ lỗi xảy ra. Vui lòng thử lại sau.", "error", "OK");
                }
            });
        }

        function initDatatable(data) {
            $("#detail-table").dataTable().fnDestroy();
            $("#detail-table").dataTable({
                stateSave: true,
                "bFilter": true,
                "bSort": false,
                "data": data,
                "bRetrieve": true,
                "bScrollCollapse": true,
                "bProcessing": true,
                "oLanguage": {
                    "sSearch": "Tìm kiếm:",
                    "sSearchPlaceholder": "",
                    "sZeroRecords": "Không có dữ liệu phù hợp",
                    "sInfo": "Hiển thị từ _START_ đến _END_ trên tổng số _TOTAL_ dòng",
                    "sEmptyTable": "Không có dữ liệu",
                    "sInfoFiltered": " - lọc ra từ _MAX_ dòng",
                    "sLengthMenu": "Hiển thị _MENU_ dòng",
                    "sProcessing": "Đang xử lý...",
                    "oPaginate": {
                        "sNext": "<i class='fa fa-chevron-right'></i>",
                        "sPrevious": "<i class='fa fa-chevron-left'></i>"
                    }
                },
                "aoColumnDefs": [
                    {
                        "aTargets": [0, 2, 3, 4, 5, 6, 7, 8 ,9],
                        "bSortable": false,
                        "sClass": "text-center"
                    },
                    {
                        "aTargets": [1],
                        "mRender": function(data, type, row) {
                            processingStatus = row[11];
                            var nameInfo = "";
                            var isAssign = "";
                            if (processingStatus == "UpdateByAutoWithoutAssignOtherStore") {
                                nameInfo = "<lable class='label label-primary p-r-10 p-l-10'style='font-size: small'>" +
                                    data +
                                    "</lable>";
                            } else {
                                nameInfo = "<lable>" + data + "</lable>";
                            }
                            if (processingStatus == "UpdateByAutoWithoutAssignOtherStore" ||
                                processingStatus == "UpdateByAutoWithoutAssign") {
                                isAssign = "<i class='fa fa-star' aria-hidden='true' style='color: #d9534f'></i >";
                            }
                            return isAssign + " " + nameInfo;
                        },
                    },
                    {
                        "aTargets": [2],
                        "mRender": function(data, type, row) {
                            if (data == "Chưa cập nhật") {
                                var info = "<lable style='color : darkblue'>" + data + "</lable>";
                            } else {
                                var info = "<lable>" + data + "</lable>";
                            }
                            return info + " ";
                        },
                    },
                    {
                        "aTargets": [3],
                        "mRender": function(data, type, row) {
                            if (data == "Chưa cập nhật") {
                                var info = "<lable style='color : darkblue'>" + data + "</lable>";
                            } else {
                                var info = "<lable>" + data + "</lable>";
                            }
                            return info + " ";
                        },
                    },
                    {
                        "aTargets": [4],

                        "mRender": function(data, type, row) {
                            check = row[6];
                            vao = row[7];
                            ra = row[8];
                            totalTime = row[4];
                            processingStatus = row[11];
                            var rsProcessingStatus = "";
                            if (processingStatus == "UpdatedByAuto" ||
                                processingStatus == "UpdatedByCheckContinueAuto" ||
                                processingStatus == "UpdateByAutoWithoutAssignOtherStore" ||
                                processingStatus == "UpdateByAutoWithoutAssign") {
                                //rsProcessingStatus = "<div class='label label-primary'><i class='fa fa-desktop' aria-hidden='true'></i></div>";
                                rsProcessingStatus =
                                    "<a title='Cập nhật tự động' class='label label-primary'><i class='fa fa-desktop' aria-hidden='true'></i></a>";
                            } else if (processingStatus == "Assign") {
                                //rsProcessingStatus = "<div class='label label-primary'>N</div>";
                                rsProcessingStatus = "<a title='Mới thêm vào ca' class='label label-primary'>N</a>";
                            } else if (processingStatus == "UpdatedByManualCanNotOveride" ||
                                processingStatus == "UpdatedByManualCanOveride") {
                                //rsProcessingStatus = "<div class='label label-primary'><i class='fa fa-exclamation-triangle' aria-hidden='true'></i></div>";
                                rsProcessingStatus =
                                    "<a title='Cập nhật thủ công' class='label label-primary'><i class='fa fa-hand-paper-o' aria-hidden='true'></i></a>";
                            }
                            //else if (processingStatus == "UpdatedByManualCanOveride") {
                            //    rsProcessingStatus = "<div class='label label-primary'><i class='fa fa-pencil-square-o' aria-hidden='true'></i></div>";
                            //}
                            //else if (processingStatus == "UpdatedByCheckContinueAuto") {
                            //    //rsProcessingStatus = "<div class='label label-primary'><i class='fa fa-play-circle' aria-hidden='true'></i></div>";
                            //    rsProcessingStatus = "<a title='Cập nhật ' class='label label-primary'><i class='fa fa-play-circle' aria-hidden='true'></i></a>";
                            //}

                            var chuan = "<div class='label label-success'>Đúng giờ</div>";
                            var tre = "<div class='label label-danger p-l-15 p-r-15'>Đi trễ</div>";
                            var som = "<div class='label label-warning'>Về sớm</div>";
                            var html = "";
                            if (check == "chưa check đủ") {
                                html = "--";
                            } else if (totalTime == "00:00:00") {
                                html = "--";
                            } else {
                                if (vao != "Chuẩn")
                                    html = tre + "<br /><br />";
                                if (ra != "Chuẩn")
                                    html = html + som;
                            }
                            if (html == "") html = rsProcessingStatus + "<br /><br />" + chuan;
                            else html = rsProcessingStatus + "<br /><br />" + html;
                            return html;
                        }
                    },
                    {
                        "aTargets": [5],
                        "mRender": function(data, type, row) {
                            data = row[4];
                            return data;
                        }
                    },
                    {
                        "aTargets": [6],
                        "mRender": function(data, type, row) {
                            data = row[9];
                            //var attId = row[5];
                            var Processing = "<div class='label label-warning'>Chờ duyệt</div>";
                            var Approved = "<div class='label label-success p-l-15 p-r-15'>Đã duyệt</div>";
                            var Reject = "<div class='label label-danger p-l-15 p-r-15'>Đã hủy</div>";
                            //var duyet = "<a title='Duyệt' class='btn btn-sm btn-success' onclick='duyetAtt(" +
                            //    attId +
                            //    ")'><i class='fa fa-check' aria-hidden='true'></i></a>";
                            //var huy = "<a title='Hủy' class='btn btn-sm btn-danger' onclick='huyAtt(" +
                            //    attId +
                            //    ")'><i class='fa fa-times' aria-hidden='true'></i></a>";
                            var result = "";
                            if (data == "Processing") result = Processing //+ " - " + duyet + " " + huy;
                            else if (data == "Approved") result = Approved;
                            else if (data == "Reject") result = Reject;
                            return result;
                        }
                    },
                    {
                        "aTargets": [7],
                        "mRender": function (data, type, row) {
                            data = row[12];
                            return data;
                        }
                    },
                    {
                        "aTargets": [8],
                        "mRender": function(data, type, row) {
                            data = row[9];
                            data2 = row[10];
                            var attId = row[5];
                            var duyet = "<a title='Duyệt' class='btn btn-sm btn-success' onclick='duyetAtt(" +
                                attId +
                                ")'><i class='fa fa-check' aria-hidden='true'></i></a>";
                            var huy = "<a title='Hủy' class='btn btn-sm btn-danger' onclick='huyAtt(" +
                                attId +
                                ")'><i class='fa fa-times' aria-hidden='true'></i></a>";
                            var result = "";
                            if (data == "Processing") result = duyet + " " + huy;
                            else {
                                if (data2 != "System") {
                                    result =
                                        "<div class='label label-primary'><i class='fa fa-user' aria-hidden='true'></i> " +
                                        data2 +
                                        "</div>";
                                }
                            }
                            //else if (data == "Approved") result = Approved;
                            //else if (data == "Reject") result = Reject;
                            return result;
                        }
                    },
                    //{
                    //    "aTargets": [7],
                    //    "mRender": function (data, type, row) {
                    //        data = row[10];
                    //        var system = "<div class='label label-primary'><i class='fa fa-desktop' aria-hidden='true'></i> Tự động</div>";
                    //        var nonSystem = "<div class='label label-primary'><i class='fa fa-user' aria-hidden='true'></i> " + data + "</div>";
                    //        if (data == "System") {
                    //            return system;
                    //        } else {
                    //            return nonSystem;
                    //        }

                    //    }
                    //},
                    {
                        "aTargets": [9],
                        "mRender": function(data, type, row) {
                            data = row[5];
                            var edit =
                                "<a title='Chỉnh sửa' class='btn btn-sm btn-primary' onclick='showEditTimekeepingModal(" +
                                    data +
                                    ")'><i class='glyphicon glyphicon-pencil'></i></a>";
                            //var del = "<a title='Xóa' class='btn btn-sm btn-danger' onclick='deleteAttendance(" +
                            //    data +
                            //    ")'><i class='glyphicon glyphicon-trash'></i></a>";
                            return edit + " " /*+ del*/;
                        }
                    }
                ],
                "bAutoWidth": false,
            });
        }

        function duyetAtt(id) {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("UpdateAttendanceStt")',
                data: {
                    'attId': id,
                    'stt': @((Int32)StatusAttendanceEnum.Approved),
                },
                success: function(result) {
                    if (result == true) {
                        ShowAlert("Cập nhật thành công", 2);
                        loadAttendance();
                    } else {
                        ShowAlert("Chưa cập nhật được. Vui lòng thử lại", 1);
                    }
                },
                error: function(error) {
                    showMessage("Có lỗi xảy ra. Vui lòng thử lại sau.", "error", "OK");
                }
            });
        }

        function huyAtt(id) {
            ShowConfirm("Bạn có muốn hủy nhân viên này ra khỏi ca?",
                function() {
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("UpdateAttendanceStt")',
                        data: {
                            'attId': id,
                            'stt': @((Int32)StatusAttendanceEnum.Reject),
                        },
                        success: function(result) {
                            if (result == true) {
                                ShowAlert("Cập nhật thành công", 2);
                                loadAttendance();
                            } else {
                                ShowAlert("Chưa cập nhật được. Vui lòng thử lại", 1);
                            }
                        },
                        error: function(error) {
                            showMessage("Có lỗi xảy ra. Vui lòng thử lại sau.", "error", "OK");
                        }
                    });
                });


        }

        function reloadEmpType() {
            var empType = -1;
            if ($("#rbEmpTypeAll").is(':checked')) {
                empType = $("#rbEmpTypeAll").val();
            } else if ($("#rbEmpTypeAssigned").is(':checked')) {
                empType = $("#rbEmpTypeAssigned").val();
            } else if ($("#rbEmpTypeNotAssigned").is(':checked')) {
                empType = $("#rbEmpTypeNotAssigned").val();
            }

            $("#EmployeeType").val(empType);
            loadAttendance();
        }

        function reloadStatus() {
            var stt = -1;
            if ($("#rbStatusAll").is(':checked')) {
                stt = $("#rbStatusAll").val();
            } else if ($("#rbStatusProcessing").is(':checked')) {
                stt = $("#rbStatusProcessing").val();
            } else if ($("#rbStatusApproved").is(':checked')) {
                stt = $("#rbStatusApproved").val();
            } else if ($("#rbStatusReject").is(':checked')) {
                stt = $("#rbStatusReject").val();
            }

            $("#Status").val(stt);
            loadAttendance();
        }

        function reloadIsLate() {
            var isLate = -1;
            if ($("#rbIsLateAll").is(':checked')) {
                isLate = $("#rbIsLateAll").val();
            } else if ($("#rbIsLate").is(':checked')) {
                isLate = $("#rbIsLate").val();
            } else if ($("#rbIsEarly").is(':checked')) {
                isLate = $("#rbIsEarly").val();
            } else if ($("#rbIsNotLate").is(':checked')) {
                isLate = $("#rbIsNotLate").val();
            }

            $("#isLate").val(isLate);
            loadAttendance();
        }

        function showEditTimekeepingModal(id) {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("PrepareEdit", "TimeKeepingReport")',
                data: {
                    'attId': id
                },
                success: function(result) {
                    $('#edit-modal-timekeeping').modal('show');
                    $('#attId').val(result.model.id);
                    $('#EditAtt').text(result.workDayEdit);
                    $('#TextAreaNote').text(result.model.note);
                    if (result.model.checkMin == "01/01/0001 00:00") {
                        var date = $('#EditAtt').text().split("-")[0].trim() + " 00:00";
                        $('#TimeFrameStart').val(date);
                    } else {
                        $('#TimeFrameStart').val(result.model.checkMin);
                    }

                    if (result.model.checkMax == "01/01/0001 00:00") {
                        var date = $('#EditAtt').text().split("-")[0].trim() + " 00:00";
                        $('#TimeFrameEnd').val(date);
                    } else {
                        $('#TimeFrameEnd').val(result.model.checkMax);
                    }

                    if (result.model.processingStatus == 2) {
                        $("#IsOverride").prop('checked', true);
                    } else {
                        $("#IsOverride").prop('checked', false);
                    }

                    if (result.model.stt == "Processing") {
                        $("#rbProcessing").prop('checked', true);
                    } else if (result.model.stt == "Approved") {
                        $("#rbApproved").prop('checked', true);
                    } else if (result.model.stt == "Reject") {
                        $("#rbReject").prop('checked', true);
                    }

                    //if (result.model.updatePerson != null & result.model.updatePerson != "System") {
                    //    $('#updatePerson').text(result.model.updatePerson);
                    //} else {
                    //    $('#updatePerson').text("N/a");}
                }
            });
        }

        $("#IsOverride").change(function() {
            if ($("#IsOverride").is(':checked')) {
                $("#isOverrideInput").val(2);
            } else {
                $("#isOverrideInput").val(3);
            }
        });

        function EditAttendance() {
            var rsStt;
            if ($("#rbApproved").is(':checked')) {
                rsStt = $("#rbApproved").val();
            } else if ($("#rbProcessing").is(':checked')) {
                rsStt = $("#rbProcessing").val();
            } else if ($("#rbReject").is(':checked')) {
                rsStt = $("#rbReject").val();
            }
            $.ajax({
                type: 'POST',
                url: '@Url.Action("EditAttendance", "TimeKeepingReport")',
                data: {
                    'attId': $('#attId').val(),
                    'currentDay': $('#EditAtt').text().split("-")[0].trim(),
                    //'duration': $('#DurationInShift').val(),
                    'checkMin': $('#TimeFrameStart').val(),
                    'checkMax': $('#TimeFrameEnd').val(),
                    'note': $('#TextAreaNote').val(),
                    'processingStatus': $('#isOverrideInput').val(),
                    'stt': rsStt
                },
                success: function(result) {
                    if (result == true) {
                        $('#edit-modal-timekeeping').modal('hide');
                        //showEmployeeInShiftModal($("#ShiftId").val());
                        loadAttendance();
                        ShowAlert("Sửa thành công", 2);
                    } else {
                        ShowAlert("Có lỗi xảy ra, vui lòng thử lại", 1);
                    }
                },
                error: function(error) {
                    ShowAlert("Có lỗi xảy ra, vui lòng thử lại", 1);
                }
            });
        }

        function exportExcellOneShift() {
            if ($("#Shift").val() == null) {
                return;
            }
            window.location.replace("@Url.Action("ExportToExcel", "Shift")" + "?shiftId=" + $("#Shift").val());
        }

    </script>
}